<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khagesh ai-nexa | Ultimate Khata Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #020617; color: white; }
        .gradient-text { background: linear-gradient(90deg, #38bdf8, #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="p-4 md:p-10 min-h-screen">

    <div class="max-w-md mx-auto">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-2xl font-extrabold tracking-tighter gradient-text">Khagesh ai-nexa</h1>
                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest italic">Professional Ledger</p>
            </div>
            <div class="text-right">
                <div id="liveClock" class="text-xl font-black text-white">00:00:00</div>
                <div id="liveDate" class="text-[8px] text-sky-400 font-bold uppercase">21 Jan 2026</div>
            </div>
        </div>

        <div class="bg-slate-900 rounded-[2.5rem] p-8 border border-white/10 shadow-2xl mb-8">
            <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">Net Balance</p>
            <h2 id="mainBalance" class="text-5xl font-black mt-2 tracking-tighter text-sky-400 italic">₹ 0</h2>
            <div class="mt-8 grid grid-cols-2 gap-3 text-center">
                <div class="bg-emerald-500/10 p-3 rounded-2xl"><p class="text-[8px] text-emerald-400 font-bold uppercase">In</p><p id="totalIn" class="text-lg font-bold">₹ 0</p></div>
                <div class="bg-rose-500/10 p-3 rounded-2xl"><p class="text-[8px] text-rose-400 font-bold uppercase">Out</p><p id="totalOut" class="text-lg font-bold">₹ 0</p></div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-10">
            <button onclick="openModal('income')" class="bg-emerald-600 p-5 rounded-3xl font-black shadow-lg active:scale-95 transition-all">CASH IN (+)</button>
            <button onclick="openModal('expense')" class="bg-rose-600 p-5 rounded-3xl font-black shadow-lg active:scale-95 transition-all">CASH OUT (-)</button>
        </div>

        <div id="ledgerItems" class="space-y-4 pb-10"></div>
    </div>

    <div id="modal" class="fixed inset-0 bg-black/95 backdrop-blur-xl hidden flex items-center justify-center p-6 z-50">
        <div class="bg-slate-900 p-8 rounded-[3rem] w-full max-w-sm border border-slate-700">
            <h2 id="modalTitle" class="text-2xl font-black mb-6 text-sky-400 italic">Add Entry</h2>
            <div class="space-y-4">
                <input id="eName" type="text" placeholder="Name" class="w-full bg-slate-800 p-4 rounded-2xl outline-none">
                <input id="ePhone" type="number" placeholder="Phone (WhatsApp)" class="w-full bg-slate-800 p-4 rounded-2xl outline-none">
                <input id="eDesc" type="text" placeholder="Description" class="w-full bg-slate-800 p-4 rounded-2xl outline-none">
                <input id="eAmount" type="number" placeholder="Amount ₹" class="w-full bg-slate-800 p-4 rounded-2xl font-bold text-xl outline-none">
            </div>
            <div class="flex gap-4 mt-8">
                <button onclick="closeModal()" class="flex-1 text-slate-500 font-bold">Cancel</button>
                <button onclick="saveEntry()" class="flex-[2] bg-sky-500 p-4 rounded-2xl font-black">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        let currentType = '';
        let records = JSON.parse(localStorage.getItem('kh_ledger_v5')) || [];

        function updateClock() {
            const now = new Date();
            document.getElementById('liveClock').innerText = now.toLocaleTimeString('en-IN', { hour12: false });
            document.getElementById('liveDate').innerText = now.toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' });
        }
        setInterval(updateClock, 1000); updateClock();

        function openModal(type) { currentType = type; document.getElementById('modal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('modal').classList.add('hidden'); }

        function saveEntry() {
            const name = document.getElementById('eName').value;
            const amount = parseFloat(document.getElementById('eAmount').value);
            if(!name || !amount) return;
            
            records.push({ 
                id: Date.now(), 
                name, 
                phone: document.getElementById('ePhone').value || '', 
                desc: document.getElementById('eDesc').value || 'N/A', 
                amount, 
                type: currentType, 
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) 
            });
            
            localStorage.setItem('kh_ledger_v5', JSON.stringify(records));
            ['eName', 'ePhone', 'eDesc', 'eAmount'].forEach(id => document.getElementById(id).value = '');
            closeModal(); render();
        }

        // DELETE FUNCTION
        function deleteEntry(id) {
            if(confirm("Kya aap is entry ko hatana chahte hain?")) {
                records = records.filter(item => item.id !== id);
                localStorage.setItem('kh_ledger_v5', JSON.stringify(records));
                render();
            }
        }

        function shareWA(name, amount, type, phone) {
            if(!phone) return alert("Number nahi mila!");
            const msg = `*Khagesh ai-nexa Update*\nHeir: ${name}\nAmount: ₹${amount}\nType: ${type.toUpperCase()}\nStatus: Settled`;
            window.open(`https://wa.me/91${phone}?text=${encodeURIComponent(msg)}`);
        }

        function render() {
            const list = document.getElementById('ledgerItems');
            let tIn = 0, tOut = 0; list.innerHTML = '';
            records.slice().reverse().forEach(item => {
                if(item.type === 'income') tIn += item.amount; else tOut += item.amount;
                list.innerHTML += `
                    <div class="bg-slate-900/50 p-6 rounded-[2rem] border border-white/5 relative group">
                        <button onclick="deleteEntry(${item.id})" class="absolute top-4 right-4 text-rose-500 hover:text-rose-400 text-[10px] font-bold uppercase">Delete</button>
                        <div class="flex justify-between items-start mb-3">
                            <div><h4 class="font-bold text-white">${item.name}</h4><p class="text-[9px] text-slate-500 uppercase">${item.desc}</p></div>
                            <p class="font-black ${item.type === 'income' ? 'text-emerald-400' : 'text-rose-400'}">₹${item.amount}</p>
                        </div>
                        <div class="flex gap-2 pt-3 border-t border-white/5">
                            <button onclick="shareWA('${item.name}', '${item.amount}', '${item.type}', '${item.phone}')" class="flex-1 bg-emerald-500/10 text-emerald-400 py-2 rounded-xl text-[9px] font-bold">WHATSAPP</button>
                            <a href="tel:${item.phone}" class="flex-1 bg-sky-500/10 text-sky-400 py-2 rounded-xl text-[9px] font-bold text-center">CALL</a>
                        </div>
                    </div>`;
            });
            document.getElementById('mainBalance').innerText = `₹ ${tIn - tOut}`;
            document.getElementById('totalIn').innerText = `₹ ${tIn}`; document.getElementById('totalOut').innerText = `₹ ${tOut}`;
        }
        render();
    </script>
</body>
    </html>
    
